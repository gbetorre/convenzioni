<?xml version="1.0" encoding="UTF-8"?>
<web-app
    version="4.0"
    xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:javaee="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xml="http://www.w3.org/XML/1998/namespace"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd">
  
    <display-name>COL - Convenzioni On Line</display-name>
    
   <!-- Note: Servlets Configuration -->
    
    <servlet>
      <description>Servlet to provide database connection</description>        
      <servlet-name>db</servlet-name>
      <servlet-class>it.col.db.DBManager</servlet-class>
      <load-on-startup>1</load-on-startup>
    </servlet>
    
    <servlet>
      <description>Servlet to cache configuration variables</description>        
      <servlet-name>config</servlet-name>
      <servlet-class>it.col.ConfigManager</servlet-class>
      <load-on-startup>2</load-on-startup>
    </servlet>
    
    <servlet>
      <description>Servlet COL entrypoint</description>        
      <servlet-name>main</servlet-name>
      <servlet-class>it.col.Main</servlet-class>
      <load-on-startup>5</load-on-startup>
    </servlet>
    <servlet-mapping>
      <servlet-name>main</servlet-name>
      <url-pattern>/</url-pattern>
    </servlet-mapping>
   
    <servlet>
      <description>Servlet to manage XHR requests and output other than text/html</description>
      <servlet-name>data</servlet-name>
      <servlet-class>it.col.Data</servlet-class>
      <load-on-startup>10</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>data</servlet-name>
        <url-pattern>/data</url-pattern>
    </servlet-mapping>  
   
    <servlet>
      <description>Servlet to manage user sessions</description>
      <servlet-name>session</servlet-name>
      <servlet-class>it.col.SessionManager</servlet-class>
    </servlet>
    <servlet-mapping>
      <servlet-name>session</servlet-name>
      <url-pattern>/auth</url-pattern>
    </servlet-mapping>
    
  <!-- Note: Raw browsing Configuration -->
    
    <servlet-mapping>
      <servlet-name>default</servlet-name>
      <url-pattern>/vendor/*</url-pattern>
      <url-pattern>/assets/*</url-pattern>
    </servlet-mapping>
    
   <!-- Note: Custom Error Pages -->

    <error-page>
      <error-code>400</error-code>
      <location>/html/400-badRequest.html</location>
    </error-page>
    <error-page>
      <error-code>401</error-code>
      <location>/html/401-unauthorized.html</location>
    </error-page>
    <error-page>
      <error-code>403</error-code>
      <location>/html/403-forbidden.html</location>
    </error-page>
    <error-page>
      <error-code>404</error-code>
      <location>/html/404-noResourceFound.html</location>
    </error-page>
    <error-page>
      <error-code>405</error-code>
      <location>/html/405-methodNotAllowed.html</location>
    </error-page>
    <error-page>
      <error-code>406</error-code>
      <location>/html/notAcceptable.html</location>
    </error-page>
    <error-page>
      <error-code>408</error-code>
      <location>/html/requestTimeout.html</location>
    </error-page>
    <error-page>
      <error-code>414</error-code>
      <location>/html/requestURITooLong.html</location>
    </error-page>
    <error-page>
      <error-code>415</error-code>
      <location>/html/unsupportedMediaType.html</location>
    </error-page>
    <error-page>
      <error-code>422</error-code>
      <location>/html/unprocessableEntity.html</location>
    </error-page>
    <error-page>
      <error-code>429</error-code>
      <location>/html/tooManyRequests.html</location>
    </error-page>
    <error-page>
      <error-code>500</error-code>
      <location>/html/500-internalServerError.html</location>
    </error-page>
    <error-page>
      <exception-type>it.col.exception.CommandException</exception-type>
      <location>/html/500-internalServerError.html</location>
    </error-page>
    <error-page>
      <error-code>501</error-code>
      <location>/html/notImplemented.html</location>
    </error-page>
    <error-page>
      <error-code>502</error-code>
      <location>/html/502-badGateway.html</location>
    </error-page>
    <error-page>
      <error-code>503</error-code>
      <location>/html/serviceUnavailable.html</location>
    </error-page>
    <error-page>
      <error-code>504</error-code>
      <location>/html/gatewayTimeout.html</location>
    </error-page>
    <error-page>
      <error-code>505</error-code>
      <location>/html/505-HTTPVersionNotSupported.html</location>
    </error-page>
    <error-page>
      <error-code>509</error-code>
      <location>/html/bandwidthLimitExceeded.html</location>
    </error-page>

   <!-- Note: Contex Params -->
   
    <context-param>
        <description>Error page</description>
        <param-name>errorJsp</param-name>
        <param-value>/jsp/error.jsp</param-value>
    </context-param>

    <context-param>
        <description></description>
        <param-name>home</param-name>
        <param-value>home</param-value>
    </context-param>

    <context-param>
        <description>Every page is mounted here</description>
        <param-name>templateJsp</param-name>
        <param-value>/jsp/template.jsp</param-value>
    </context-param>

    <context-param>
        <description>Parameter to identify the Command</description>
        <param-name>entToken</param-name>
        <param-value>q</param-value>
    </context-param>
    
    <context-param>
        <description>Parameter to identify the entity</description>
        <param-name>objToken</param-name>
        <param-value>o</param-value>
    </context-param>    

    <context-param>
        <description>Parameter to identify the output format</description>
        <param-name>outToken</param-name>
        <param-value>out</param-value>
    </context-param>
    
    <context-param>
        <description>Plugins directory</description>
        <param-name>urlDirFrameworks</param-name>
        <param-value>vendor/</param-value>
    </context-param>
    
    <context-param>
        <description>Stylesheets directory</description>
        <param-name>urlDirStyles</param-name>
        <param-value>assets/css/</param-value>
    </context-param>
    
    <context-param>
        <description>Client side scripts directory</description>
        <param-name>urlDirScripts</param-name>
        <param-value>assets/js/</param-value>
    </context-param>
    
    <context-param>
        <description>Images directory</description>
        <param-name>urlDirImages</param-name>
        <param-value>assets/images/</param-value>
    </context-param>

    <context-param>
        <description>Application Root</description>
        <param-name>appName</param-name>
        <param-value>/col</param-value>
    </context-param>
    
   <!-- Note: Resource Refs -->
    
    <resource-ref>
        <description>
            Resource reference to a factory for java.sql.Connection
            instances that may be used for talking to a particular
            database that is configured in the context.xml file.
        </description>
        <res-ref-name>
            jdbc/coldev
        </res-ref-name>
        <res-type>
            javax.sql.DataSource
        </res-type>
        <res-auth>Container</res-auth>
    </resource-ref>
    
    <resource-ref>
        <description>
            Resource reference to a factory for java.sql.Connection
            instances that may be used for talking to a particular
            database that is configured in the context.xml file.
        </description>
        <res-ref-name>
            jdbc/col
        </res-ref-name>
        <res-type>
            javax.sql.DataSource
        </res-type>
        <res-auth>Container</res-auth>
    </resource-ref>

</web-app>
